<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record model="ir.ui.view" id="standard_request_report">
      <field name="name">Standard Requet</field>
      <field name="model">standard.request.report</field>
      <field name="arch" type="xml">
        <form>
          <group>

          <field name="tag_id"/>
        </group>
          <footer> 
            <button name='print_report' string='Imprimir' type='object'/>
            <button special='cancel' string='Cancelar'/>
          </footer>
        </form>
      </field>
    </record>
 
        <record model="ir.actions.act_window" id="actions_wizard_report">
            <field name="name">Reporte Consumo</field>
            <field name="res_model">standard.request.report</field>
<!--            <field name="view_type">form</field>-->
            <field name="view_mode">form</field>
            <field name="target">new</field>
        </record>

        <menuitem name="Informe"
                  action="actions_wizard_report"
                  parent="standard_requests.menu_root"
                  id="menu_wizard_report"
                  sequence="16"/>

<!--  <report-->
<!--      id="report_standard"-->
<!--      model="standard.request.report"-->
<!--      string="Reporte Consumido"-->
<!--      report_type="qweb-pdf"-->
<!--      name="standard_requests.report_template"-->
<!--      file="standard_requests.report_template"-->
<!--      print_report_name="'Reporte Consumo - %s' % (object.tag_id.name)"-->
<!--  />-->

  <record id="report_standard" model="ir.actions.report">
            <field name="name">Reporte Consumido</field>
            <field name="model">standard.request.report</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">standard_requests.report_template</field>
            <field name="report_file">standard_requests.report_template</field>
            <field name="binding_model_id" ref="model_standard_request_report"/>
            <field name="binding_type">report</field>
  </record>


  <template id="report_template">
    <t t-call="web.html_container">
      <t t-foreach="docs" t-as="o">
        <t t-call="web.internal_layout">
          <div class="page">
            <h2 class="text-center">Reporte Consumo - <span t-field="o.tag_id"/></h2>

            <div class="row">
              <t t-set='datas' t-value='o.get_tag_info(o)'/> 

            <table class="table table-sm o_main_table mt32" style='font-size:small;'>
              <thead>
                <th>Producto</th>
                <th class="text-right">Cnt. Solic. a Almacen</th>
                <th class="text-right">Cnt. Entregadas por Almacen</th>
                <th class="text-right">Cnt. Comprada</th>
                <th class="text-right">Cnt. Restante</th>
              </thead>

              <tbody>
                <t t-foreach="datas" t-as="l">
                  <tr>
                    <td>
                      <span t-esc="l.name"/>
                    </td>
                    <td class='text-right'>
                      <span t-esc="'{:,}'.format(l_value['cant'])"/>
                    </td>
                    <td class="text-right">
                      <span t-esc="'{:,}'.format(l_value['pedido'])"/>
                    </td>
                    <td class="text-right">
                      <span t-esc="'{:,}'.format(l_value['comprado'])"/>
                    </td>
                    <td class="text-right">
                      <span t-esc="'{:,}'.format(l_value['comprado']-l_value['pedido'])"/>
                    </td>
                  </tr>
                </t>
              </tbody>
            </table>

          </div>
         </div>
        </t>
      </t>
    </t>
  </template>

</odoo>
